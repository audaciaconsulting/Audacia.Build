# Template: checkout source code and setup NuGet/npm caching
steps:
  # Checkout the source code repository
  - checkout: self
    clean: true
    submodules: true
    lfs: true
    fetchDepth: 0

  # Cache NuGet global-packages
  - task: Cache@2
    displayName: "Cache NuGet global-packages"
    inputs:
      key: 'nuget | "$(Agent.OS)" | **/*.csproj,**/*.props,**/*.targets'
      restoreKeys: 'nuget | "$(Agent.OS)"'
      path: 'C:\Users\VssAdministrator\.nuget\packages'

  # Authenticate to Azure Artifacts
  - task: NuGetAuthenticate@1
    displayName: "Authenticate to Azure Artifacts"

  # Cache npm downloads (used when an npm install path is needed)
  - task: Cache@2
    displayName: "Cache npm cache folder"
    inputs:
      key: 'npm | "$(Agent.OS)" | **/package-lock.json'
      restoreKeys: |
        npm | "$(Agent.OS)"
      path: '$(Pipeline.Workspace)/.npm'
