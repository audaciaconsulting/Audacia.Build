# This YAML file defines a step template for publishing a Software Bill of Materials (SBOM) artifact.
# The template is conditional based on the `publishArtifact` parameter.

parameters:
  # Parameter to control whether the artifact should be published.
  - name: publishArtifact
    type: boolean
    default: true  # Default is true, meaning the artifact will be published unless explicitly disabled.

  # Parameter to specify the name of the artifact to be published.
  - name: artifactName
    type: string
    default: 'sbom-files'  # Default artifact name is 'sbom-files'.

steps:
  # Conditional step to publish the SBOM artifact if `publishArtifact` is true.
  - ${{ if eq(parameters.publishArtifact, true) }}:
      - task: PublishPipelineArtifact@1  # Task to publish a pipeline artifact.
        displayName: "Publish SBOM artifact"  # Display name for the task in the pipeline UI.
        inputs:
          targetPath: "$(Agent.TempDirectory)/sbom"  # Path to the SBOM files to be published.
          publishLocation: pipeline  # Specifies that the artifact will be published to the pipeline.
          artifact: ${{ parameters.artifactName }}  # Name of the artifact, as defined by the `artifactName` parameter.
