# Template: discover and log npm manifests (package.json and package-lock.json)
steps:
  # Step: Discover and log npm manifests
  # - Uses PowerShell to search for `package.json` and `package-lock.json` files in the workspace
  # - Recursively scans the directory specified by `$(System.DefaultWorkingDirectory)`
  # - Logs the paths of discovered files for debugging purposes
  # - Groups the output for better readability in the pipeline logs
  - pwsh: |
      # Start a log group for better organization in the pipeline output
      Write-Host "##[group]Debug: list npm manifests"
      
      # Log the workspace root directory
      Write-Host "Workspace root: $(System.DefaultWorkingDirectory)"
      
      # Search and log all `package-lock.json` files
      "---- package-lock.json files ----"
      Get-ChildItem -Path '$(System.DefaultWorkingDirectory)' -Recurse -Filter package-lock.json -File -EA SilentlyContinue | Select-Object -Expand FullName
      
      # Search and log all `package.json` files
      "---- package.json files ----"
      Get-ChildItem -Path '$(System.DefaultWorkingDirectory)' -Recurse -Filter package.json -File -EA SilentlyContinue | Select-Object -Expand FullName
      
      # End the log group
      Write-Host "##[endgroup]"
    displayName: "Discover and log npm manifests"
